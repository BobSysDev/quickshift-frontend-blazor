@page "/SwitchReply/{Id:long}"
@using DTOs
@using DTOs.Shift
@using QuickShiftUI.Services
@inject IShiftSwitchReplyService ReplyService
@inject NavigationManager Navigation

<h3>Switch Reply Details</h3>

<AuthorizeView>
    <NotAuthorized>
        <p>Please log in to view this information.</p>
    </NotAuthorized>

    <Authorized>
        @if (reply != null)
        {
            <div class="card mt-4">
                <div class="card-header">
                    <h4>Reply Details</h4>
                </div>

                <div class="card-body">
                    <p>
                        <b>Reply ID: </b><span>@reply.Id</span>
                    </p>
                    <p>
                        <b>Request ID: </b><span>@reply.RequestId</span>
                    </p>
                    <p>
                        <b>Target Employee ID: </b><span>@reply.TargetEmployeeId</span>
                    </p>
                    <p>
                        <b>Target Shift ID: </b><span>@reply.TargetShiftId</span>
                    </p>
                    <p>
                        <b>Details: </b><span>@reply.Details</span>
                    </p>
                    <p>
                        <b>Origin Accepted: </b><span>@(reply.OriginAccepted ? "Yes" : "No")</span>
                    </p>
                    <p>
                        <b>Target Accepted: </b><span>@(reply.TargetAccepted ? "Yes" : "No")</span>
                    </p>
                </div>
            </div>
        }
        else
        {
            <p>Loading reply details...</p>
        }
    </Authorized>
</AuthorizeView>

<p></p>
<button class="btn btn-secondary mt-4" @onclick="GoBack">Return to My Replies</button>

@code {
    [Parameter] public long Id { get; set; }
    private ShiftSwitchReplyDTO? reply;

    protected override async Task OnParametersSetAsync()
    {
        try
        {
            reply = await ReplyService.GetShiftSwitchReplyByIdAsync(Id);
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading reply details: {ex.Message}");
            Navigation.NavigateTo("/MyReplies");
        }
    }

    private void GoBack()
    {
        Navigation.NavigateTo("/MyReplies");
    }
}
